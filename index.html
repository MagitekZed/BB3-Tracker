<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BB3 League Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" /> <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <header id="desktopHeader" class="desktop-only">
    <div class="header-row">
      <div class="brand">ğŸˆ BB3 Tracker</div>
      <div class="header-nav">
        <button id="navDeskLeagues" class="nav-link active">Leagues</button>
        <button id="navDeskAdmin" class="nav-link">Admin</button>
      </div>
      <div class="header-tools">
        <details class="key-details">
          <summary class="key-summary">ğŸ”‘ Edit Key</summary>
          <div class="key-dropdown">
            <input type="password" id="editKeyInput" placeholder="Enter Key..." />
            <button id="rememberKeyBtn" class="primary-btn">Save</button>
          </div>
        </details>
      </div>
    </div>
    <div id="breadcrumbs" class="breadcrumbs">
      <span class="crumb">Home</span>
    </div>
  </header>

  <header id="mobileHeader" class="mobile-only">
    <div class="brand">ğŸˆ BB3 Tracker</div>
    <button id="mobileKeyToggle" class="icon-btn">ğŸ”‘</button>
  </header>
  
  <div id="mobileKeyModal" class="mobile-key-modal hidden">
    <div class="modal-content">
      <h3>ğŸ” Admin Access</h3>
      <p>Enter your League Edit Key:</p>
      <input type="password" id="mobileKeyInput" class="large-input" placeholder="Edit Key..." />
      <div class="modal-actions">
        <button id="mobileKeySaveBtn" class="primary-btn">Save & Close</button>
        <button onclick="document.getElementById('mobileKeyModal').classList.add('hidden')" class="secondary-btn">Cancel</button>
      </div>
    </div>
  </div>

  <main id="mainContent">
    <div id="globalStatus" class="status hidden"></div>

    <section id="leagueListSection">
      <h2>Leagues</h2>
      <div class="small">Select a league to view standings.</div>
      <div style="margin: 1rem 0;">
        <button id="leagueCreateBtn" class="primary-btn">+ New League</button>
      </div>
      <div id="leagueListContainer"></div>
    </section>

    <section id="leagueViewSection" class="hidden">
      <div id="leagueHeader"></div>
      
      <section id="leagueTeamsSection">
        <h3>Standings</h3>
        <div id="standingsContainer"></div>
        <div id="rosterQuickViewContainer" style="margin-top:1rem"></div>
      </section>

      <section id="leagueMatchesSection">
        <h3>Matches & Schedule</h3>
        <div class="card desktop-only">
          <h4>Schedule Match</h4>
          <div class="inline-input">
            <input type="number" id="schedRound" value="1" style="width:50px">
            <select id="schedHome"><option>Home...</option></select>
            <span>vs</span>
            <select id="schedAway"><option>Away...</option></select>
            <button id="schedAddBtn">Add</button>
          </div>
        </div>
        <button id="mobileAddMatchBtn" class="fab-btn mobile-only">+</button>

        <div id="inProgressContainer"></div>
        <div id="matchesContainer"></div>
      </section>
    </section>

    <section id="leagueManageSection" class="hidden">
       <div class="card"><div class="card-header"><h2 id="leagueManageHeader">Manage League</h2><button id="leagueManageBackBtn">â† Back</button></div><div id="leagueManageStatus"></div></div>
       <div id="leagueInfoCard" class="card">... (Content populated by JS) ...</div>
       <div id="leagueTeamsCard" class="card"><div id="leagueManageTeamsList"></div><button id="leagueManageAddNewTeamBtn">+ Team</button></div>
       <div id="teamEditorCard" class="card"><div id="leagueManageTeamEditor"></div></div>
       <div class="card"><button id="leagueManageSaveBtn" class="primary-btn">Save Changes</button><div id="deleteLeagueContainer"></div></div>
       <div class="hidden">
         <input id="leagueManageIdInput"><input id="leagueManageNameInput"><input id="leagueManageSeasonInput"><select id="leagueManageStatusSelect"></select>
         <input id="leagueManagePointsWinInput"><input id="leagueManagePointsDrawInput"><input id="leagueManagePointsLossInput">
         <input id="leagueManageMaxTeamsInput"><input id="leagueManageLockTeamsInput">
       </div>
    </section>

    <section id="teamViewSection" class="hidden">
      <div class="card">
        <div class="card-header"><h2 id="teamHeader">Team</h2><div><button id="teamBackBtn">â† Back</button> <button id="teamManageBtn">Manage</button></div></div>
        <div id="teamSummary"></div>
      </div>
      <div id="teamRosterContainer"></div>
    </section>

    <section id="scoreboardSection" class="hidden">
      <div class="card">
        <div class="card-header"><h2>Live Match</h2><div><button id="scoreboardRefreshBtn">â†»</button><button id="scoreboardBackToMatchBtn">Exit</button></div></div>
        <div class="scoreboard-layout">
           <div class="team-control"><div id="sbHomeName">Home</div><div id="sbHomeScore" class="score-display">0</div><div class="turn-box">Turn: <span id="sbHomeTurn">0</span></div><button class="primary-btn" onclick="enterCoachMode('home')">Play as Home</button></div>
           <div class="match-control"><button id="endGameBtn" class="primary-btn">End Game</button></div>
           <div class="team-control"><div id="sbAwayName">Away</div><div id="sbAwayScore" class="score-display">0</div><div class="turn-box">Turn: <span id="sbAwayTurn">0</span></div><button class="primary-btn" onclick="enterCoachMode('away')">Play as Away</button></div>
        </div>
      </div>
      <div class="scoreboard-rosters"><div id="scoreboardHomeRoster"></div><div id="scoreboardAwayRoster"></div></div>
    </section>

    <section id="coachSection" class="hidden">
      <div class="coach-header">
        <div class="coach-header-top"><div class="coach-team-name" id="coachTeamName">My Team</div><div class="coach-score" id="coachScoreDisplay">0-0</div></div>
        <div class="coach-resources"><div id="coachRerolls"></div><span id="coachTurnDisplay">0</span></div>
      </div>
      <div id="coachRosterList"></div>
      <div class="coach-footer"><button class="secondary-btn" onclick="exitCoachMode()">Exit</button><button class="primary-btn" id="coachEndTurnBtn">End Turn</button></div>
    </section>

    <section id="adminSection" class="hidden">
      <h2>Admin Tools</h2>
      <div class="card">
        <h3>Repository Health</h3>
        <button id="scanBtn">Scan Repository</button>
        <div id="scanResults"></div>
      </div>
      <div class="card">
        <h3>Raw JSON</h3>
        <textarea id="leagueTextarea" style="width:100%; height:200px"></textarea>
        <button id="loadBtn">Load</button> <button id="saveBtn">Save</button>
      </div>
    </section>

  </main>

  <nav id="mobileNavBar" class="mobile-only">
    <button id="navMobLeagues" class="tab-btn active">
      <span class="tab-icon">ğŸ†</span>
      <span class="tab-label">Leagues</span>
    </button>
    <button id="navMobMatch" class="tab-btn">
      <span class="tab-icon">âš”ï¸</span>
      <span class="tab-label">Match</span>
    </button>
    <button id="navMobAdmin" class="tab-btn">
      <span class="tab-icon">âš™ï¸</span>
      <span class="tab-label">Admin</span>
    </button>
  </nav>

  <div id="skillModal" class="modal hidden">
    <div class="modal-content"><div class="modal-header"><h3 id="skillModalTitle"></h3><button class="close-btn" onclick="closeSkillModal()">Ã—</button></div><div id="skillModalBody"></div></div>
  </div>
  <datalist id="skillList"></datalist>

  <script src="app.js"></script>
</body>
</html>
